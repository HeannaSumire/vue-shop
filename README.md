# 本项目为vue3开发的电商平台项目，后台数据和接口来自小兔鲜电商平台项目

## 技术栈

- vue3+pinia+vite
- pinia作为全局状态管理

## 项目文件结构

- apis API接口文件夹
- assets 静态资源
- components 组件
- composables 组合函数文件夹
- directives 全局指令文件夹（如自定义懒加载全局指令）
- router 路由
- stores 全局状态管理
- styles 全局样式
- utils 工具函数
- views 页面

## 项目页面结构

### 1.Layout 主页

- 包含头部、导航、吸顶导航、尾部、HOME主页内容
- HOME作为二级导航包含：左侧分类和轮播图、新鲜好物、人气推荐、产品列表

### 项目难点+解决

- 对相似模块进行组件封装。解决：把可能发生变化的部分抽象成组件参数（props/插槽）。主标题和副标题是纯文本，抽象为prop传入；主体内容是复杂的模板，抽象成插槽传入。

- 使用懒加载进行性能优化。解决：判断图片是否进入视口区域,如果图片进入视口，发送图片资源请求.通过 app.directive 创建了一个名为 img-lazy 的自定义指令。在 mounted 内部使用useIntersectionObserver API，isIntersecting来检测元素是否出现在视口中。一旦元素出现在视口中，并将其 src 属性设置为指令中传递的值（binding.value）。当图片加载完成后，它将替换原始元素的 src 属性。其中存在重复监听的问题。解决思路：在监听的图片第一次完成加载之后就停止监听。

#### 性能优化

- 解决路由缓存问题：用户从/category/id1 导航到/category/id2时，相同的组件实例会被重复使用。这是因为两个路由都渲染同一个组件，比起销毁再创建，复用更高效。但这也意味着组件的生命周期函数不会被调用，又因为之前获取数据的方法写在onMounted钩子里，导致更换路由时数据并没有更新渲染。(只有参数变化时，会发生组件复用)
- 解决方法：使用beforeRouteUpdate导航钩子（路由守卫），在每次路由更新之前执行，在回调中执行需要数据更新的业务逻辑

- 做了许多业务代码封装，提高可维护性。
